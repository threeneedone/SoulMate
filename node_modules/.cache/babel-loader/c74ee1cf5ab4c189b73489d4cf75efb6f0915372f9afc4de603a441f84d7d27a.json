{"ast":null,"code":"import{useState,useEffect}from'react';import{Modal,PurchaseModal,ShareModal}from'./components/Modals';// 导入React Hooks\n// =====================================================================\n// 文档页面组件\n// =====================================================================\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DocumentationPage=_ref=>{let{onClose}=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 max-w-lg w-full text-left animate-fade-in font-sans\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6 border-b-2 border-rose-400 pb-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl sm:text-4xl font-extrabold text-gray-900 font-serif\",children:\"\\u529F\\u80FD\\u8BF4\\u660E\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-500 hover:text-gray-900 transition-colors duration-300\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-8 w-8\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6 text-gray-700 leading-relaxed overflow-y-auto max-h-[70vh]\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u6B22\\u8FCE\\u4F7F\\u7528\\u300C\\u5BBF\\u547D\\u53F8\\u300D\\uFF0C\\u8FD9\\u662F\\u4E00\\u6B3E\\u7ED3\\u5408\\u4E86\\u56FD\\u98CE\\u7384\\u5B66\\u4E0E\\u5148\\u8FDB AI \\u89C6\\u89C9\\u6280\\u672F\\u7684\\u8DA3\\u5473\\u5FC3\\u7406\\u63A2\\u7D22\\u5E94\\u7528\\u3002\\u6211\\u4EEC\\u4E0D\\u63D0\\u4F9B\\u751F\\u786C\\u7684\\u201C\\u7B97\\u547D\\u201D\\u7ED3\\u679C\\uFF0C\\u800C\\u662F\\u901A\\u8FC7\\u4F20\\u7EDF\\u667A\\u6167\\u4E0E\\u73B0\\u4EE3\\u79D1\\u6280\\u7684\\u878D\\u5408\\uFF0C\\u4E3A\\u60A8\\u63CF\\u7ED8\\u4E00\\u5E45\\u72EC\\u4E00\\u65E0\\u4E8C\\u7684\\u300C\\u6B63\\u7F18\\u753B\\u50CF\\u300D\\uFF0C\\u52A9\\u60A8\\u66F4\\u597D\\u5730\\u8BA4\\u8BC6\\u81EA\\u6211\\uFF0C\\u5F00\\u542F\\u4E00\\u6BB5\\u7F8E\\u597D\\u7684\\u60C5\\u611F\\u65C5\\u7A0B\\u3002\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 font-serif\",children:\"\\u4E00\\u3001\\u6838\\u5FC3\\u529F\\u80FD\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800\",children:\"1. \\u6447\\u7B7E\\u6C42\\u7F18\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u8FD9\\u662F\\u300C\\u5BBF\\u547D\\u53F8\\u300D\\u6700\\u6838\\u5FC3\\u7684\\u529F\\u80FD\\u3002\\u901A\\u8FC7\\u8F93\\u5165\\u60A8\\u7684\\u51FA\\u751F\\u4FE1\\u606F\\uFF0C\\u6211\\u4EEC\\u5F3A\\u5927\\u7684\\u540E\\u53F0\\u7B97\\u6CD5\\u5C06\\u542F\\u52A8\\u4E00\\u573A\\u8DE8\\u8D8A\\u53E4\\u4ECA\\u7684\\u63A8\\u6F14\\uFF1A\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-disc list-inside space-y-2 pl-4\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u7384\\u5B66\\u63A8\\u6F14\"}),\"\\uFF1A\\u6839\\u636E\\u60A8\\u63D0\\u4F9B\\u7684\\u516C\\u5386\\u751F\\u65E5\\u3001\\u51FA\\u751F\\u65F6\\u95F4\\u548C\\u51FA\\u751F\\u5730\\uFF0C\\u7CFB\\u7EDF\\u5C06\\u63A8\\u7B97\\u51FA\\u60A8\\u7684\\u751F\\u8FB0\\u516B\\u5B57\\u3001\\u4E94\\u884C\\u547D\\u76D8\\u548C\\u592B\\u59BB\\u5BAB\\u72B6\\u6001\\u7B49\\u4F20\\u7EDF\\u7384\\u5B66\\u4FE1\\u606F\\u3002\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"AI \\u89C6\\u89C9\\u751F\\u6210\"}),\"\\uFF1A\\u7CFB\\u7EDF\\u4F1A\\u5C06\\u7384\\u5B66\\u63A8\\u6F14\\u51FA\\u7684\\u7ED3\\u679C\\uFF0C\\u8F6C\\u6362\\u4E3A AI \\u80FD\\u591F\\u7406\\u89E3\\u7684\\u7CBE\\u51C6\\u63D0\\u793A\\u8BCD\\uFF08Prompt\\uFF09\\uFF0C\\u5E76\\u7531\\u5F3A\\u5927\\u7684 AI \\u89C6\\u89C9\\u6A21\\u578B\\u751F\\u6210\\u4E00\\u5E45\\u5145\\u6EE1\\u56FD\\u98CE\\u97F5\\u5473\\u7684\\u300C\\u6B63\\u7F18\\u753B\\u50CF\\u300D\\u3002\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u8BD7\\u610F\\u89E3\\u8BFB\"}),\"\\uFF1A\\u9664\\u4E86\\u753B\\u50CF\\uFF0CAI \\u8FD8\\u4F1A\\u6839\\u636E\\u60A8\\u7684\\u547D\\u76D8\\u7279\\u70B9\\uFF0C\\u751F\\u6210\\u4E00\\u6BB5\\u5145\\u6EE1\\u8BD7\\u610F\\u3001\\u72EC\\u4E00\\u65E0\\u4E8C\\u7684\\u300C\\u6B63\\u7F18\\u5224\\u8BCD\\u300D\\uFF0C\\u4EE5\\u53CA\\u4E00\\u4EFD\\u8BE6\\u7EC6\\u7684\\u6027\\u683C\\u4E0E\\u7279\\u8D28\\u89E3\\u8BFB\\u62A5\\u544A\\u3002\"]})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800\",children:\"2. \\u514D\\u8D39\\u83B7\\u53D6\\u673A\\u4F1A\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u6211\\u4EEC\\u81F4\\u529B\\u4E8E\\u8BA9\\u66F4\\u591A\\u7528\\u6237\\u4F53\\u9A8C\\u5230\\u300C\\u5BBF\\u547D\\u53F8\\u300D\\u7684\\u9B45\\u529B\\u3002\\u60A8\\u53EF\\u4EE5\\u901A\\u8FC7\\u4EE5\\u4E0B\\u4E24\\u79CD\\u65B9\\u5F0F\\u514D\\u8D39\\u83B7\\u53D6\\u6447\\u7B7E\\u673A\\u4F1A\\uFF1A\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-disc list-inside space-y-2 pl-4\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u6BCF\\u65E5\\u7B7E\\u5230\"}),\"\\uFF1A\\u6BCF\\u5929\\u767B\\u5F55\\u5E94\\u7528\\uFF0C\\u5373\\u53EF\\u83B7\\u5F97\\u4E00\\u6B21\\u514D\\u8D39\\u6447\\u7B7E\\u673A\\u4F1A\\u3002\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u5206\\u4EAB\\u83B7\\u53D6\"}),\"\\uFF1A\\u5C06\\u60A8\\u7684\\u6B63\\u7F18\\u7ED3\\u679C\\u5206\\u4EAB\\u81F3\\u5C0F\\u7EA2\\u4E66\\u7B49\\u793E\\u4EA4\\u5E73\\u53F0\\uFF0C\\u5E76\\u4E0A\\u4F20\\u622A\\u56FE\\uFF0C\\u7ECF\\u7CFB\\u7EDF\\u9A8C\\u8BC1\\u540E\\u5373\\u53EF\\u83B7\\u5F97\\u4E00\\u6B21\\u989D\\u5916\\u7684\\u514D\\u8D39\\u6447\\u7B7E\\u673A\\u4F1A\\uFF08\\u6BCF 24 \\u5C0F\\u65F6\\u53EF\\u83B7\\u5F97\\u4E00\\u6B21\\uFF09\\u3002\"]})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800\",children:\"3. \\u8D2D\\u4E70\\u4E0E\\u4F1A\\u5458\\u670D\\u52A1\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-disc list-inside space-y-2 pl-4\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u7ACB\\u5373\\u8D2D\\u4E70\"}),\"\\uFF1A\\u5F53\\u60A8\\u7684\\u514D\\u8D39\\u673A\\u4F1A\\u7528\\u5B8C\\u540E\\uFF0C\\u53EF\\u4EE5\\u9009\\u62E9\\u76F4\\u63A5\\u8D2D\\u4E70\\u5355\\u6B21\\u6447\\u7B7E\\u673A\\u4F1A\\uFF0C\\u4EF7\\u683C\\u4E3A \\xA528.8\\u3002\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u6708\\u8001\\u4F1A\\u5458\"}),\"\\uFF1A\\u5982\\u679C\\u60A8\\u5E0C\\u671B\\u957F\\u671F\\u63A2\\u7D22\\uFF0C\\u53EF\\u4EE5\\u8003\\u8651\\u6210\\u4E3A\\u300C\\u6708\\u8001\\u4F1A\\u5458\\u300D\\u3002\\u4F1A\\u5458\\u5C06\\u4EAB\\u53D7\\u6BCF\\u6708\\u591A\\u6B21\\u7684\\u514D\\u8D39\\u91CD\\u5851\\u673A\\u4F1A\\u3001\\u6DF1\\u5EA6\\u62A5\\u544A\\u89E3\\u9501\\u7B49\\u4E13\\u5C5E\\u6743\\u76CA\\uFF0C\\u5927\\u5E45\\u63D0\\u5347\\u60A8\\u7684\\u5E94\\u7528\\u4F53\\u9A8C\\u3002\"]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 font-serif\",children:\"\\u4E8C\\u3001\\u4F7F\\u7528\\u6B65\\u9AA4\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"list-decimal list-inside space-y-2 pl-4\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u8F93\\u5165\\u4FE1\\u606F\"}),\"\\uFF1A\\u5728\\u9996\\u9875\\u7684\\u6447\\u7B7E\\u9875\\u9762\\uFF0C\\u51C6\\u786E\\u586B\\u5199\\u60A8\\u7684\\u51FA\\u751F\\u65E5\\u671F\\u3001\\u51FA\\u751F\\u65F6\\u95F4\\u548C\\u51FA\\u751F\\u5730\\u3002\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u6447\\u7B7E\\u6C42\\u7F18\"}),\"\\uFF1A\\u70B9\\u51FB\\u300C\\u6447\\u7B7E\\u6C42\\u7F18\\u300D\\u6309\\u94AE\\uFF0C\\u7CFB\\u7EDF\\u5C06\\u8FDB\\u5165\\u63A8\\u6F14\\u548C\\u751F\\u6210\\u72B6\\u6001\\uFF0C\\u8BF7\\u8010\\u5FC3\\u7B49\\u5F85\\u7247\\u523B\\u3002\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u67E5\\u770B\\u7ED3\\u679C\"}),\"\\uFF1A\\u751F\\u6210\\u5B8C\\u6210\\u540E\\uFF0C\\u60A8\\u5C06\\u770B\\u5230\\u60A8\\u7684\\u300C\\u6B63\\u7F18\\u753B\\u50CF\\u300D\\uFF0C\\u4EE5\\u53CA\\u5BF9\\u5E94\\u7684\\u5224\\u8BCD\\u548C\\u8BE6\\u7EC6\\u89E3\\u8BFB\\u62A5\\u544A\\u3002\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u5206\\u4EAB\\u6216\\u91CD\\u6765\"}),\"\\uFF1A\\u60A8\\u53EF\\u4EE5\\u9009\\u62E9\\u5C06\\u7ED3\\u679C\\u4FDD\\u5B58\\u3001\\u5206\\u4EAB\\u5230\\u793E\\u4EA4\\u5E73\\u53F0\\uFF0C\\u6216\\u8005\\u5728\\u673A\\u4F1A\\u5145\\u8DB3\\u7684\\u60C5\\u51B5\\u4E0B\\uFF0C\\u518D\\u6B21\\u6447\\u7B7E\\u6C42\\u53D6\\u65B0\\u7684\\u6B63\\u7F18\\u3002\"]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 font-serif\",children:\"\\u4E09\\u3001\\u514D\\u8D23\\u58F0\\u660E\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u300C\\u5BBF\\u547D\\u53F8\\u300D\\u662F\\u4E00\\u6B3E\\u57FA\\u4E8E\\u4F20\\u7EDF\\u6587\\u5316\\u548C\\u73B0\\u4EE3\\u79D1\\u6280\\u7684**\\u8DA3\\u5473\\u5FC3\\u7406\\u63A2\\u7D22\\u5DE5\\u5177**\\u3002\\u6240\\u6709\\u751F\\u6210\\u7ED3\\u679C\\u4EC5\\u4F9B\\u5A31\\u4E50\\u548C\\u81EA\\u6211\\u63A2\\u7D22\\uFF0C\\u4E0D\\u6784\\u6210\\u4EFB\\u4F55\\u5F62\\u5F0F\\u7684\\u79D1\\u5B66\\u6216\\u4E13\\u4E1A\\u5EFA\\u8BAE\\u3002\\u8BF7\\u7406\\u6027\\u770B\\u5F85\\uFF0C\\u4FDD\\u6301\\u79EF\\u6781\\u5FC3\\u6001\\uFF0C\\u751F\\u6D3B\\u548C\\u60C5\\u611F\\u7684\\u51B3\\u5B9A\\u6743\\u59CB\\u7EC8\\u5728\\u60A8\\u81EA\\u5DF1\\u624B\\u4E2D\\u3002\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 pt-4 border-t-2 border-gray-200\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:onClose,className:\"w-full py-3 px-6 bg-gray-200 text-gray-800 font-semibold rounded-xl hover:bg-gray-300 transition-colors duration-300\",children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"back-arrow\",className:\"mr-2\",children:\"\\uD83D\\uDD19\"}),\"\\u8FD4\\u56DE\"]})})]});};// 主应用组件\nconst API_BASE_URL='http://localhost:5000/api/v1';// 本地开发环境 API 地址\nexport default function App(){const[step,setStep]=useState('input');// 'input', 'loading', 'result'\nconst[birthDate,setBirthDate]=useState('');const[birthTime,setBirthTime]=useState('');const[birthPlace,setBirthPlace]=useState('');const[result,setResult]=useState(null);const[modalMessage,setModalMessage]=useState(null);const[isGenerating,setIsGenerating]=useState(false);const[showDocumentation,setShowDocumentation]=useState(false);// 用户数据状态\nconst[freeChances,setFreeChances]=useState(1);// 默认1次免费机会\nconst[lastSharedAt,setLastSharedAt]=useState(null);const[userId,setUserId]=useState('');// 初始化用户ID\nuseEffect(()=>{// 从localStorage获取用户ID，如果没有则生成新的\nlet storedUserId=localStorage.getItem('soulmate_user_id');if(!storedUserId){storedUserId='user_'+Math.random().toString(36).substring(2,15);localStorage.setItem('soulmate_user_id',storedUserId);}setUserId(storedUserId);},[]);// 定期刷新用户数据，确保免费机会数正确\nuseEffect(()=>{if(!userId)return;const interval=setInterval(()=>{fetchUserData();},30000);// 每30秒刷新一次\nreturn()=>clearInterval(interval);},[userId]);const[showShareModal,setShowShareModal]=useState(false);const[showPurchaseModal,setShowPurchaseModal]=useState(false);// 后端 API 调用函数\n// =====================================================================\n// 获取用户数据\nconst fetchUserData=async()=>{if(!userId)return;try{const response=await fetch(`${API_BASE_URL}/users/${userId}`);if(!response.ok)throw new Error('获取用户数据失败');const data=await response.json();setFreeChances(data.free_chances||1);setLastSharedAt(data.last_shared_at);}catch(error){console.error('获取用户数据失败:',error);}};// 在userId变化时获取用户数据\nuseEffect(()=>{if(userId){fetchUserData();}},[userId]);// 提交生成任务\nconst submitGenerationTask=async data=>{console.log(`正在向后端提交生成任务: ${API_BASE_URL}/generate/submit`);const response=await fetch(`${API_BASE_URL}/generate/submit`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});if(!response.ok){const errorData=await response.json().catch(()=>({}));throw new Error(`${errorData.error||'生成任务失败。'} (状态码: ${response.status})`);}const result=await response.json();return result;};// 获取任务状态\nconst getGenerationStatus=async taskId=>{console.log(`正在查询任务状态: ${API_BASE_URL}/generate/status/${taskId}`);const response=await fetch(`${API_BASE_URL}/generate/status/${taskId}`);if(!response.ok){const errorData=await response.json().catch(()=>({}));throw new Error(`${errorData.error||'查询任务状态失败。'} (状态码: ${response.status})`);}return await response.json();};// 获取任务结果\nconst getGenerationResult=async taskId=>{console.log(`正在获取任务结果: ${API_BASE_URL}/results/${taskId}`);const response=await fetch(`${API_BASE_URL}/results/${taskId}`);if(!response.ok){const errorData=await response.json().catch(()=>({}));throw new Error(`${errorData.error||'获取任务结果失败。'} (状态码: ${response.status})`);}return await response.json();};// 轮询任务状态\nconst pollTaskStatus=async taskId=>{const checkStatus=async()=>{try{const statusResponse=await getGenerationStatus(taskId);if(statusResponse.status==='SUCCESS'){const result=await getGenerationResult(taskId);setResult(result);setStep('result');return;}else if(statusResponse.status==='FAILED'){setModalMessage('生成失败：任务处理出错。请重试。');setStep('input');return;}else{// 继续轮询\nsetTimeout(checkStatus,2000);}}catch(error){console.error('轮询任务状态失败:',error);setModalMessage(`轮询失败：${error.message}。请重试。`);setStep('input');}};// 开始轮询\nsetTimeout(checkStatus,2000);};// 处理分享成功\nconst shareForChance=async userId=>{console.log(`正在向后端提交分享验证: ${API_BASE_URL}/share/verify`);// 这里应该有图片上传逻辑\n// 简化示例，实际应用中需要添加FormData处理\nconst response=await fetch(`${API_BASE_URL}/share/verify`,{method:'POST',headers:{'Content-Type':'application/json'},// 实际应用中应该有图片数据\nbody:JSON.stringify({userId})});if(!response.ok)throw new Error('分享验证失败');return await response.json();};// 处理购买成功\nconst purchaseChance=async orderId=>{console.log(`正在向后端确认支付成功: ${API_BASE_URL}/payment/confirm`);const response=await fetch(`${API_BASE_URL}/payment/confirm`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({order_id:orderId})});if(!response.ok)throw new Error('购买确认失败');return await response.json();};// =====================================================================\n// 判断是否可以再次分享\nconst canShareAgain=!lastSharedAt||new Date()-new Date(lastSharedAt)>24*60*60*1000;// 提交生成任务并保存到后端\nconst handleSubmit=async e=>{e.preventDefault();if(!birthDate||!birthTime||!birthPlace){setModalMessage('请填写完整的出生信息。');return;}setStep('loading');setIsGenerating(true);try{const response=await submitGenerationTask({birthDate,birthTime,birthPlace,userId,callbackUrl:`${window.location.origin}/callback`// 可选的回调URL\n});setFreeChances(response.free_chances_remaining);// 根据后端返回更新\nsetModalMessage(null);// 启动轮询任务状态\npollTaskStatus(response.taskId);}catch(error){console.error(\"Error submitting task:\",error);// 检查是否是402错误（免费机会用完）\nif(error.message.includes('402')){// 先等待获取用户数据完成，确保免费机会数正确\nawait fetchUserData();// 然后再设置模态框消息和返回到输入页面\nsetModalMessage('免费机会已用完，请通过分享或购买获取更多机会。');setStep('input');}else{setModalMessage(`生成失败：${error.message}。请重试。`);setStep('input');}}finally{setIsGenerating(false);}};// 处理小红书分享成功的逻辑\nconst handleShareSuccess=async()=>{try{await shareForChance(userId);// 立即更新免费机会数量\nsetFreeChances(prev=>prev+1);setModalMessage('感谢分享！您已获得一次新的求缘机会。');setShowShareModal(false);setLastSharedAt(new Date().toISOString());// 更新分享时间\n// 刷新用户数据，确保数据一致性\nfetchUserData();}catch(error){console.error(\"Error sharing:\",error);setModalMessage(`分享失败：${error.message}`);}};// 处理购买成功的逻辑\nconst handlePurchaseSuccess=async orderId=>{try{await purchaseChance(orderId);// 立即更新免费机会数量\nsetFreeChances(prev=>prev+1);setModalMessage('购买成功！您已获得新的求签机会。');setShowPurchaseModal(false);// 刷新用户数据，确保数据一致性\nfetchUserData();}catch(error){console.error(\"Error purchasing:\",error);setModalMessage(`购买失败：${error.message}`);}};const renderContent=()=>{if(showDocumentation){return/*#__PURE__*/_jsx(DocumentationPage,{onClose:()=>setShowDocumentation(false)});}// 移除了loadingUser逻辑，因为不再需要登录\nswitch(step){case'input':return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 transform transition-all duration-500 scale-100 hover:scale-105 max-w-lg w-full font-sans\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl sm:text-5xl font-extrabold text-gray-900 mb-2 font-serif tracking-wide\",children:\"\\u5BBF\\u547D\\u53F8\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg sm:text-xl text-gray-600 mb-6 sm:mb-8 font-sans\",children:\"\\u6267\\u638C\\u5BBF\\u547D\\u5929\\u673A\\uFF0C\\u7ED8\\u5236\\u6B63\\u7F18\\u753B\\u5377\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"w-full space-y-4 sm:space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"birthDate\",className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"\\u51FA\\u751F\\u65E5\\u671F\"}),/*#__PURE__*/_jsx(\"input\",{id:\"birthDate\",type:\"date\",className:\"w-full p-3 border border-gray-300 rounded-xl focus:ring-4 focus:ring-rose-200 focus:border-rose-400 transition-all duration-300\",value:birthDate,onChange:e=>setBirthDate(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"birthTime\",className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"\\u51FA\\u751F\\u65F6\\u95F4\"}),/*#__PURE__*/_jsx(\"input\",{id:\"birthTime\",type:\"time\",className:\"w-full p-3 border border-gray-300 rounded-xl focus:ring-4 focus:ring-rose-200 focus:border-rose-400 transition-all duration-300\",value:birthTime,onChange:e=>setBirthTime(e.target.value),required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-xs text-gray-500\",children:\"\\u7CBE\\u786E\\u5230\\u65F6\\u8FB0\\u6709\\u52A9\\u4E8E\\u66F4\\u51C6\\u786E\\u7684\\u6F14\\u7B97\\u3002\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"birthPlace\",className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"\\u51FA\\u751F\\u5730\"}),/*#__PURE__*/_jsx(\"input\",{id:\"birthPlace\",type:\"text\",placeholder:\"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u51FA\\u751F\\u5730 (\\u4F8B: \\u5317\\u4EAC)\",className:\"w-full p-3 border border-gray-300 rounded-xl focus:ring-4 focus:ring-rose-200 focus:border-rose-400 transition-all duration-300\",value:birthPlace,onChange:e=>setBirthPlace(e.target.value),required:true})]}),freeChances>0?/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",disabled:isGenerating,className:\"w-full py-3 sm:py-4 px-6 bg-gradient-to-r from-red-500 to-rose-600 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl hover:from-rose-600 hover:to-red-700 focus:outline-none focus:ring-4 focus:ring-rose-300 focus:ring-offset-2 transition-all duration-300 disabled:from-gray-400 disabled:to-gray-500 disabled:shadow-none disabled:transform-none\",children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"shaking-bell\",className:\"mr-2\",children:\"\\uD83D\\uDD14\"}),\"\\u6447\\u7B7E\\u6C42\\u7F18 (\",freeChances,\"\\u6B21\\u514D\\u8D39)\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"w-full space-y-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-lg font-semibold text-gray-700\",children:\"\\u514D\\u8D39\\u673A\\u4F1A\\u5DF2\\u7528\\u5B8C\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setShowShareModal(true),className:\"w-full py-3 sm:py-4 px-6 bg-gradient-to-r from-pink-500 to-rose-500 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl hover:from-rose-600 hover:to-pink-600 focus:outline-none focus:ring-4 focus:ring-pink-300 focus:ring-offset-2 transition-all duration-300\",children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"social-media\",className:\"mr-2\",children:\"\\uD83D\\uDCF8\"}),\"\\u5206\\u4EAB\\u5C0F\\u7EA2\\u4E66\\uFF0C\\u514D\\u8D39\\u83B7\\u5F97\\u4E00\\u6B21\"]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setShowPurchaseModal(true),className:\"w-full py-3 sm:py-4 px-6 bg-gradient-to-r from-amber-400 to-amber-600 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl hover:from-amber-600 hover:to-amber-700 focus:outline-none focus:ring-4 focus:ring-amber-300 focus:ring-offset-2 transition-all duration-300\",children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"shopping-cart\",className:\"mr-2\",children:\"\\uD83D\\uDED2\"}),\"\\u7ACB\\u5373\\u8D2D\\u4E70 (\\xA528.8)\"]})]})]})]});case'loading':return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 max-w-sm w-full font-sans\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"relative w-24 h-24 sm:w-28 sm:h-28\",children:/*#__PURE__*/_jsxs(\"svg\",{className:\"w-full h-full animate-spin-slow\",viewBox:\"0 0 100 100\",xmlns:\"http://www.w3.org/2000/svg\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"50\",cy:\"50\",r:\"48\",fill:\"none\",stroke:\"#fecaca\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M50,2 A48,48 0 0,1 50,98 A24,24 0 0,1 50,50 A24,24 0 0,0 50,98 A48,48 0 0,0 50,2\",fill:\"#d2691e\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M50,2 A48,48 0 0,0 50,98 M50,2 A48,48 0 0,1 50,98\",fill:\"#fff\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"50\",cy:\"26\",r:\"12\",fill:\"#fff\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"50\",cy:\"74\",r:\"12\",fill:\"#d2691e\"})]})}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-6 sm:mt-8 text-xl sm:text-2xl font-bold text-gray-800 font-serif text-center\",children:\"\\u5929\\u673A\\u6B63\\u5728\\u6F14\\u7B97...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm sm:text-md text-gray-500 text-center font-sans\",children:\"\\u4E00\\u6BB5\\u4F73\\u7F18\\uFF0C\\u5373\\u5C06\\u6D6E\\u73B0...\"})]});case'result':return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 max-w-lg w-full text-center animate-fade-in font-sans\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl sm:text-4xl font-bold text-gray-900 mb-4 font-serif\",children:\"\\u4F60\\u7684\\u6B63\\u7F18\"}),/*#__PURE__*/_jsx(\"img\",{src:(result===null||result===void 0?void 0:result.hdImage)||'/default_image.svg',alt:\"\\u6B63\\u7F18\\u753B\\u50CF\",className:`w-full max-w-[20rem] aspect-[2/3] object-cover rounded-2xl shadow-xl transition-all duration-500`,onError:e=>{e.target.src='/default_image.svg';}}),result.poeticText&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-6 sm:mt-8 text-lg sm:text-xl text-gray-700 italic font-serif leading-relaxed px-4 border-l-4 border-rose-400\",children:result.poeticText}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 sm:mt-10 w-full space-y-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl sm:text-2xl font-bold text-gray-800 font-serif border-b-2 border-rose-400 pb-2\",children:\"\\u8BE6\\u7EC6\\u89E3\\u8BFB\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-left text-base sm:text-lg text-gray-700 leading-relaxed whitespace-pre-wrap\",children:result.detailedAnalysis})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 sm:mt-8 w-full flex\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{// 清除结果并返回输入页面\nsetStep('input');setResult(null);// 刷新用户数据，确保免费机会数量正确\nfetchUserData();},className:\"flex-1 py-3 sm:py-4 px-6 bg-gray-200 text-gray-800 font-semibold rounded-xl hover:bg-gray-300 transition-colors duration-300\",children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"repeat\",className:\"mr-2\",children:\"\\uD83D\\uDD04\"}),\"\\u91CD\\u65B0\\u6C42\\u7B7E\"]})})]});default:return null;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-rose-50 to-orange-100 flex items-center justify-center p-4 sm:p-6 font-sans\",children:[/*#__PURE__*/_jsx(\"style\",{children:`\n        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap');\n        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');\n        .font-serif {\n          font-family: 'Noto Serif SC', serif;\n        }\n        .font-sans {\n          font-family: 'Inter', sans-serif;\n        }\n        .animate-fade-in {\n          animation: fadeIn 0.5s ease-out forwards;\n        }\n        .animate-pop-in {\n          animation: popIn 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;\n        }\n        .animate-scale-in {\n          animation: scaleIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;\n        }\n        .animate-spin-slow {\n          animation: spin 3s linear infinite;\n        }\n        .animate-shake {\n          animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both;\n          transform: translate3d(0, 0, 0);\n          backface-visibility: hidden;\n          perspective: 1000px;\n        }\n        .animate-fade-in-up {\n            animation: fadeInUp 0.6s ease-out forwards;\n        }\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes popIn {\n          from { transform: scale(0.95); opacity: 0; }\n          to { transform: scale(1); opacity: 1; }\n        }\n        @keyframes scaleIn {\n          from { transform: scale(0); opacity: 0; }\n          to { transform: scale(1); opacity: 1; }\n        }\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        @keyframes shake {\n          10%, 90% { transform: translate3d(-1px, 0, 0); }\n          20%, 80% { transform: translate3d(2px, 0, 0); }\n          30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }\n          40%, 60% { transform: translate3d(4px, 0, 0); }\n        }\n        @keyframes fadeInUp {\n            from {\n                opacity: 0;\n                transform: translateY(20px);\n            }\n            to {\n                opacity: 1;\n                transform: translateY(0);\n            }\n        }\n        `}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-2xl relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-4 right-4 z-40\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowDocumentation(!showDocumentation),className:\"flex items-center space-x-2 py-2 px-4 bg-white bg-opacity-80 backdrop-filter backdrop-blur-lg text-gray-700 font-semibold rounded-full shadow-lg hover:bg-opacity-100 hover:text-rose-500 transition-all duration-300\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 6.253v13m0-13C10.832 5.467 9.5 5 8 5c-4 0-4 6-4 6s4 6 4 6c1.5 0 2.832-.467 4-1.253m0 0C13.168 18.533 14.5 19 16 19c4 0 4-6 4-6s-4-6-4-6c-1.5 0-2.832.467-4 1.253\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"\\u529F\\u80FD\\u8BF4\\u660E\"})]})}),renderContent()]}),modalMessage&&/*#__PURE__*/_jsx(Modal,{message:modalMessage,onClose:()=>setModalMessage(null)}),showShareModal&&/*#__PURE__*/_jsx(ShareModal,{onShareSuccess:handleShareSuccess,onClose:()=>setShowShareModal(false),canShareAgain:canShareAgain}),showPurchaseModal&&/*#__PURE__*/_jsx(PurchaseModal,{onPurchaseSuccess:handlePurchaseSuccess,onClose:()=>setShowPurchaseModal(false),API_BASE_URL:API_BASE_URL})]});}","map":{"version":3,"names":["useState","useEffect","Modal","PurchaseModal","ShareModal","jsx","_jsx","jsxs","_jsxs","DocumentationPage","_ref","onClose","className","children","onClick","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","role","API_BASE_URL","App","step","setStep","birthDate","setBirthDate","birthTime","setBirthTime","birthPlace","setBirthPlace","result","setResult","modalMessage","setModalMessage","isGenerating","setIsGenerating","showDocumentation","setShowDocumentation","freeChances","setFreeChances","lastSharedAt","setLastSharedAt","userId","setUserId","storedUserId","localStorage","getItem","Math","random","toString","substring","setItem","interval","setInterval","fetchUserData","clearInterval","showShareModal","setShowShareModal","showPurchaseModal","setShowPurchaseModal","response","fetch","ok","Error","data","json","free_chances","last_shared_at","error","console","submitGenerationTask","log","method","headers","body","JSON","stringify","errorData","catch","status","getGenerationStatus","taskId","getGenerationResult","pollTaskStatus","checkStatus","statusResponse","setTimeout","message","shareForChance","purchaseChance","orderId","order_id","canShareAgain","Date","handleSubmit","e","preventDefault","callbackUrl","window","location","origin","free_chances_remaining","includes","handleShareSuccess","prev","toISOString","handlePurchaseSuccess","renderContent","onSubmit","htmlFor","id","type","value","onChange","target","required","placeholder","disabled","cx","cy","r","src","hdImage","alt","onError","poeticText","detailedAnalysis","onShareSuccess","onPurchaseSuccess"],"sources":["C:/Users/libao/Desktop/soulmate/SoulMate/src/app.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Modal, PurchaseModal, ShareModal } from './components/Modals';\r\n\r\n// 导入React Hooks\r\n\r\n// =====================================================================\r\n// 文档页面组件\r\n// =====================================================================\r\nconst DocumentationPage = ({ onClose }) => (\r\n  <div className=\"p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 max-w-lg w-full text-left animate-fade-in font-sans\">\r\n    <div className=\"flex justify-between items-center mb-6 border-b-2 border-rose-400 pb-2\">\r\n      <h1 className=\"text-3xl sm:text-4xl font-extrabold text-gray-900 font-serif\">功能说明</h1>\r\n      <button onClick={onClose} className=\"text-gray-500 hover:text-gray-900 transition-colors duration-300\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n        </svg>\r\n      </button>\r\n    </div>\r\n    <div className=\"space-y-6 text-gray-700 leading-relaxed overflow-y-auto max-h-[70vh]\">\r\n      <p>欢迎使用「宿命司」，这是一款结合了国风玄学与先进 AI 视觉技术的趣味心理探索应用。我们不提供生硬的“算命”结果，而是通过传统智慧与现代科技的融合，为您描绘一幅独一无二的「正缘画像」，助您更好地认识自我，开启一段美好的情感旅程。</p>\r\n\r\n      <h2 className=\"text-2xl font-bold text-gray-800 font-serif\">一、核心功能</h2>\r\n      <h3 className=\"text-xl font-semibold text-gray-800\">1. 摇签求缘</h3>\r\n      <p>这是「宿命司」最核心的功能。通过输入您的出生信息，我们强大的后台算法将启动一场跨越古今的推演：</p>\r\n      <ul className=\"list-disc list-inside space-y-2 pl-4\">\r\n        <li><strong>玄学推演</strong>：根据您提供的公历生日、出生时间和出生地，系统将推算出您的生辰八字、五行命盘和夫妻宫状态等传统玄学信息。</li>\r\n        <li><strong>AI 视觉生成</strong>：系统会将玄学推演出的结果，转换为 AI 能够理解的精准提示词（Prompt），并由强大的 AI 视觉模型生成一幅充满国风韵味的「正缘画像」。</li>\r\n        <li><strong>诗意解读</strong>：除了画像，AI 还会根据您的命盘特点，生成一段充满诗意、独一无二的「正缘判词」，以及一份详细的性格与特质解读报告。</li>\r\n      </ul>\r\n\r\n      <h3 className=\"text-xl font-semibold text-gray-800\">2. 免费获取机会</h3>\r\n      <p>我们致力于让更多用户体验到「宿命司」的魅力。您可以通过以下两种方式免费获取摇签机会：</p>\r\n      <ul className=\"list-disc list-inside space-y-2 pl-4\">\r\n        <li><strong>每日签到</strong>：每天登录应用，即可获得一次免费摇签机会。</li>\r\n        <li><strong>分享获取</strong>：将您的正缘结果分享至小红书等社交平台，并上传截图，经系统验证后即可获得一次额外的免费摇签机会（每 24 小时可获得一次）。</li>\r\n      </ul>\r\n\r\n      <h3 className=\"text-xl font-semibold text-gray-800\">3. 购买与会员服务</h3>\r\n      <ul className=\"list-disc list-inside space-y-2 pl-4\">\r\n        <li><strong>立即购买</strong>：当您的免费机会用完后，可以选择直接购买单次摇签机会，价格为 ¥28.8。</li>\r\n        <li><strong>月老会员</strong>：如果您希望长期探索，可以考虑成为「月老会员」。会员将享受每月多次的免费重塑机会、深度报告解锁等专属权益，大幅提升您的应用体验。</li>\r\n      </ul>\r\n\r\n      <h2 className=\"text-2xl font-bold text-gray-800 font-serif\">二、使用步骤</h2>\r\n      <ol className=\"list-decimal list-inside space-y-2 pl-4\">\r\n        <li><strong>输入信息</strong>：在首页的摇签页面，准确填写您的出生日期、出生时间和出生地。</li>\r\n        <li><strong>摇签求缘</strong>：点击「摇签求缘」按钮，系统将进入推演和生成状态，请耐心等待片刻。</li>\r\n        <li><strong>查看结果</strong>：生成完成后，您将看到您的「正缘画像」，以及对应的判词和详细解读报告。</li>\r\n        <li><strong>分享或重来</strong>：您可以选择将结果保存、分享到社交平台，或者在机会充足的情况下，再次摇签求取新的正缘。</li>\r\n      </ol>\r\n\r\n      <h2 className=\"text-2xl font-bold text-gray-800 font-serif\">三、免责声明</h2>\r\n      <p>「宿命司」是一款基于传统文化和现代科技的**趣味心理探索工具**。所有生成结果仅供娱乐和自我探索，不构成任何形式的科学或专业建议。请理性看待，保持积极心态，生活和情感的决定权始终在您自己手中。</p>\r\n    </div>\r\n    <div className=\"mt-6 pt-4 border-t-2 border-gray-200\">\r\n      <button\r\n        onClick={onClose}\r\n        className=\"w-full py-3 px-6 bg-gray-200 text-gray-800 font-semibold rounded-xl hover:bg-gray-300 transition-colors duration-300\"\r\n      >\r\n        <span role=\"img\" aria-label=\"back-arrow\" className=\"mr-2\">🔙</span>\r\n        返回\r\n      </button>\r\n    </div>\r\n  </div>\r\n);\r\n\r\n// 主应用组件\r\nconst API_BASE_URL = 'http://localhost:5000/api/v1'; // 本地开发环境 API 地址\r\n\r\nexport default function App() {\r\n  const [step, setStep] = useState('input'); // 'input', 'loading', 'result'\r\n  const [birthDate, setBirthDate] = useState('');\r\n  const [birthTime, setBirthTime] = useState('');\r\n  const [birthPlace, setBirthPlace] = useState('');\r\n  const [result, setResult] = useState(null);\r\n  const [modalMessage, setModalMessage] = useState(null);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [showDocumentation, setShowDocumentation] = useState(false);\r\n\r\n  // 用户数据状态\r\n  const [freeChances, setFreeChances] = useState(1); // 默认1次免费机会\r\n  const [lastSharedAt, setLastSharedAt] = useState(null);\r\n  const [userId, setUserId] = useState('');\r\n\r\n  // 初始化用户ID\r\n  useEffect(() => {\r\n    // 从localStorage获取用户ID，如果没有则生成新的\r\n    let storedUserId = localStorage.getItem('soulmate_user_id');\r\n    if (!storedUserId) {\r\n      storedUserId = 'user_' + Math.random().toString(36).substring(2, 15);\r\n      localStorage.setItem('soulmate_user_id', storedUserId);\r\n    }\r\n    setUserId(storedUserId);\r\n  }, []);\r\n\r\n  // 定期刷新用户数据，确保免费机会数正确\r\n  useEffect(() => {\r\n    if (!userId) return;\r\n\r\n    const interval = setInterval(() => {\r\n      fetchUserData();\r\n    }, 30000); // 每30秒刷新一次\r\n\r\n    return () => clearInterval(interval);\r\n  }, [userId]);\r\n  const [showShareModal, setShowShareModal] = useState(false);\r\n  const [showPurchaseModal, setShowPurchaseModal] = useState(false);\r\n\r\n  // 后端 API 调用函数\r\n  // =====================================================================\r\n  \r\n  // 获取用户数据\r\n  const fetchUserData = async () => {\r\n    if (!userId) return;\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/users/${userId}`);\r\n      if (!response.ok) throw new Error('获取用户数据失败');\r\n      const data = await response.json();\r\n      setFreeChances(data.free_chances || 1);\r\n      setLastSharedAt(data.last_shared_at);\r\n    } catch (error) {\r\n      console.error('获取用户数据失败:', error);\r\n    }\r\n  };\r\n\r\n  // 在userId变化时获取用户数据\r\n  useEffect(() => {\r\n    if (userId) {\r\n      fetchUserData();\r\n    }\r\n  }, [userId]);\r\n\r\n  // 提交生成任务\r\n  const submitGenerationTask = async (data) => {\r\n    console.log(`正在向后端提交生成任务: ${API_BASE_URL}/generate/submit`);\r\n    const response = await fetch(`${API_BASE_URL}/generate/submit`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      throw new Error(`${errorData.error || '生成任务失败。'} (状态码: ${response.status})`);\r\n    }\r\n    const result = await response.json();\r\n    return result;\r\n  };\r\n\r\n  // 获取任务状态\r\n  const getGenerationStatus = async (taskId) => {\r\n    console.log(`正在查询任务状态: ${API_BASE_URL}/generate/status/${taskId}`);\r\n    const response = await fetch(`${API_BASE_URL}/generate/status/${taskId}`);\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      throw new Error(`${errorData.error || '查询任务状态失败。'} (状态码: ${response.status})`);\r\n    }\r\n    return await response.json();\r\n  };\r\n\r\n  // 获取任务结果\r\n  const getGenerationResult = async (taskId) => {\r\n    console.log(`正在获取任务结果: ${API_BASE_URL}/results/${taskId}`);\r\n    const response = await fetch(`${API_BASE_URL}/results/${taskId}`);\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      throw new Error(`${errorData.error || '获取任务结果失败。'} (状态码: ${response.status})`);\r\n    }\r\n    return await response.json();\r\n  };\r\n\r\n  // 轮询任务状态\r\n  const pollTaskStatus = async (taskId) => {\r\n    const checkStatus = async () => {\r\n      try {\r\n        const statusResponse = await getGenerationStatus(taskId);\r\n        if (statusResponse.status === 'SUCCESS') {\r\n          const result = await getGenerationResult(taskId);\r\n          setResult(result);\r\n          setStep('result');\r\n          return;\r\n        } else if (statusResponse.status === 'FAILED') {\r\n          setModalMessage('生成失败：任务处理出错。请重试。');\r\n          setStep('input');\r\n          return;\r\n        } else {\r\n          // 继续轮询\r\n          setTimeout(checkStatus, 2000);\r\n        }\r\n      } catch (error) {\r\n        console.error('轮询任务状态失败:', error);\r\n        setModalMessage(`轮询失败：${error.message}。请重试。`);\r\n        setStep('input');\r\n      }\r\n    };\r\n\r\n    // 开始轮询\r\n    setTimeout(checkStatus, 2000);\r\n  };\r\n\r\n  // 处理分享成功\r\n  const shareForChance = async (userId) => {\r\n    console.log(`正在向后端提交分享验证: ${API_BASE_URL}/share/verify`);\r\n    // 这里应该有图片上传逻辑\r\n    // 简化示例，实际应用中需要添加FormData处理\r\n    const response = await fetch(`${API_BASE_URL}/share/verify`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      // 实际应用中应该有图片数据\r\n      body: JSON.stringify({ userId }),\r\n    });\r\n    if (!response.ok) throw new Error('分享验证失败');\r\n    return await response.json();\r\n  };\r\n\r\n  // 处理购买成功\r\n  const purchaseChance = async (orderId) => {\r\n    console.log(`正在向后端确认支付成功: ${API_BASE_URL}/payment/confirm`);\r\n    const response = await fetch(`${API_BASE_URL}/payment/confirm`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({ order_id: orderId }),\r\n    });\r\n    if (!response.ok) throw new Error('购买确认失败');\r\n    return await response.json();\r\n  };\r\n  // =====================================================================\r\n\r\n  // 判断是否可以再次分享\r\n  const canShareAgain = !lastSharedAt || (new Date() - new Date(lastSharedAt)) > 24 * 60 * 60 * 1000;\r\n\r\n  // 提交生成任务并保存到后端\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!birthDate || !birthTime || !birthPlace) {\r\n      setModalMessage('请填写完整的出生信息。');\r\n      return;\r\n    }\r\n    \r\n    setStep('loading');\r\n    setIsGenerating(true);\r\n\r\n    try {\r\n      const response = await submitGenerationTask({ \r\n        birthDate, \r\n        birthTime, \r\n        birthPlace, \r\n        userId, \r\n        callbackUrl: `${window.location.origin}/callback` // 可选的回调URL\r\n      });\r\n\r\n      setFreeChances(response.free_chances_remaining); // 根据后端返回更新\r\n      setModalMessage(null);\r\n\r\n      // 启动轮询任务状态\r\n      pollTaskStatus(response.taskId);\r\n    } catch (error) {\r\n      console.error(\"Error submitting task:\", error);\r\n      // 检查是否是402错误（免费机会用完）\r\n      if (error.message.includes('402')) {\r\n        // 先等待获取用户数据完成，确保免费机会数正确\r\n        await fetchUserData();\r\n        // 然后再设置模态框消息和返回到输入页面\r\n        setModalMessage('免费机会已用完，请通过分享或购买获取更多机会。');\r\n        setStep('input');\r\n      } else {\r\n        setModalMessage(`生成失败：${error.message}。请重试。`);\r\n        setStep('input');\r\n      }\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n};\r\n\r\n  // 处理小红书分享成功的逻辑\r\n  const handleShareSuccess = async () => {\r\n    try {\r\n      await shareForChance(userId);\r\n      // 立即更新免费机会数量\r\n      setFreeChances(prev => prev + 1);\r\n      setModalMessage('感谢分享！您已获得一次新的求缘机会。');\r\n      setShowShareModal(false);\r\n      setLastSharedAt(new Date().toISOString()); // 更新分享时间\r\n      // 刷新用户数据，确保数据一致性\r\n      fetchUserData();\r\n    } catch (error) {\r\n      console.error(\"Error sharing:\", error);\r\n      setModalMessage(`分享失败：${error.message}`);\r\n    }\r\n  };\r\n\r\n  // 处理购买成功的逻辑\r\n  const handlePurchaseSuccess = async (orderId) => {\r\n    try {\r\n      await purchaseChance(orderId);\r\n      // 立即更新免费机会数量\r\n      setFreeChances(prev => prev + 1);\r\n      setModalMessage('购买成功！您已获得新的求签机会。');\r\n      setShowPurchaseModal(false);\r\n      // 刷新用户数据，确保数据一致性\r\n      fetchUserData();\r\n    } catch (error) {\r\n      console.error(\"Error purchasing:\", error);\r\n      setModalMessage(`购买失败：${error.message}`);\r\n    }\r\n  };\r\n  \r\n  const renderContent = () => {\r\n    if (showDocumentation) {\r\n      return <DocumentationPage onClose={() => setShowDocumentation(false)} />;\r\n    }\r\n\r\n    // 移除了loadingUser逻辑，因为不再需要登录\r\n\r\n    switch (step) {\r\n      case 'input':\r\n        return (\r\n          <div className=\"flex flex-col items-center p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 transform transition-all duration-500 scale-100 hover:scale-105 max-w-lg w-full font-sans\">\r\n            <h1 className=\"text-4xl sm:text-5xl font-extrabold text-gray-900 mb-2 font-serif tracking-wide\">宿命司</h1>\r\n            <p className=\"text-lg sm:text-xl text-gray-600 mb-6 sm:mb-8 font-sans\">执掌宿命天机，绘制正缘画卷</p>\r\n            <form onSubmit={handleSubmit} className=\"w-full space-y-4 sm:space-y-6\">\r\n              <div>\r\n                <label htmlFor=\"birthDate\" className=\"block text-sm font-medium text-gray-700 mb-1\">出生日期</label>\r\n                <input\r\n                  id=\"birthDate\"\r\n                  type=\"date\"\r\n                  className=\"w-full p-3 border border-gray-300 rounded-xl focus:ring-4 focus:ring-rose-200 focus:border-rose-400 transition-all duration-300\"\r\n                  value={birthDate}\r\n                  onChange={(e) => setBirthDate(e.target.value)}\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"birthTime\" className=\"block text-sm font-medium text-gray-700 mb-1\">出生时间</label>\r\n                <input\r\n                  id=\"birthTime\"\r\n                  type=\"time\"\r\n                  className=\"w-full p-3 border border-gray-300 rounded-xl focus:ring-4 focus:ring-rose-200 focus:border-rose-400 transition-all duration-300\"\r\n                  value={birthTime}\r\n                  onChange={(e) => setBirthTime(e.target.value)}\r\n                  required\r\n                />\r\n                <p className=\"mt-1 text-xs text-gray-500\">精确到时辰有助于更准确的演算。</p>\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"birthPlace\" className=\"block text-sm font-medium text-gray-700 mb-1\">出生地</label>\r\n                <input\r\n                  id=\"birthPlace\"\r\n                  type=\"text\"\r\n                  placeholder=\"请输入您的出生地 (例: 北京)\"\r\n                  className=\"w-full p-3 border border-gray-300 rounded-xl focus:ring-4 focus:ring-rose-200 focus:border-rose-400 transition-all duration-300\"\r\n                  value={birthPlace}\r\n                  onChange={(e) => setBirthPlace(e.target.value)}\r\n                  required\r\n                />\r\n              </div>\r\n              \r\n              {freeChances > 0 ? (\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={isGenerating}\r\n                  className=\"w-full py-3 sm:py-4 px-6 bg-gradient-to-r from-red-500 to-rose-600 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl hover:from-rose-600 hover:to-red-700 focus:outline-none focus:ring-4 focus:ring-rose-300 focus:ring-offset-2 transition-all duration-300 disabled:from-gray-400 disabled:to-gray-500 disabled:shadow-none disabled:transform-none\"\r\n                >\r\n                  <span role=\"img\" aria-label=\"shaking-bell\" className=\"mr-2\">🔔</span>\r\n                  摇签求缘 ({freeChances}次免费)\r\n                </button>\r\n              ) : (\r\n                <div className=\"w-full space-y-4\">\r\n                  <p className=\"text-center text-lg font-semibold text-gray-700\">免费机会已用完</p>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setShowShareModal(true)}\r\n                    className=\"w-full py-3 sm:py-4 px-6 bg-gradient-to-r from-pink-500 to-rose-500 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl hover:from-rose-600 hover:to-pink-600 focus:outline-none focus:ring-4 focus:ring-pink-300 focus:ring-offset-2 transition-all duration-300\"\r\n                  >\r\n                    <span role=\"img\" aria-label=\"social-media\" className=\"mr-2\">📸</span>\r\n                    分享小红书，免费获得一次\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setShowPurchaseModal(true)}\r\n                    className=\"w-full py-3 sm:py-4 px-6 bg-gradient-to-r from-amber-400 to-amber-600 text-white font-bold text-lg rounded-xl shadow-lg hover:shadow-xl hover:from-amber-600 hover:to-amber-700 focus:outline-none focus:ring-4 focus:ring-amber-300 focus:ring-offset-2 transition-all duration-300\"\r\n                  >\r\n                    <span role=\"img\" aria-label=\"shopping-cart\" className=\"mr-2\">🛒</span>\r\n                    立即购买 (¥28.8)\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </form>\r\n          </div>\r\n        );\r\n\r\n      case 'loading':\r\n        return (\r\n          <div className=\"flex flex-col items-center justify-center p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 max-w-sm w-full font-sans\">\r\n            <div className=\"relative w-24 h-24 sm:w-28 sm:h-28\">\r\n              <svg className=\"w-full h-full animate-spin-slow\" viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <circle cx=\"50\" cy=\"50\" r=\"48\" fill=\"none\" stroke=\"#fecaca\" strokeWidth=\"4\"/>\r\n                <path d=\"M50,2 A48,48 0 0,1 50,98 A24,24 0 0,1 50,50 A24,24 0 0,0 50,98 A48,48 0 0,0 50,2\" fill=\"#d2691e\"/>\r\n                <path d=\"M50,2 A48,48 0 0,0 50,98 M50,2 A48,48 0 0,1 50,98\" fill=\"#fff\"/>\r\n                <circle cx=\"50\" cy=\"26\" r=\"12\" fill=\"#fff\"/>\r\n                <circle cx=\"50\" cy=\"74\" r=\"12\" fill=\"#d2691e\"/>\r\n              </svg>\r\n            </div>\r\n            <p className=\"mt-6 sm:mt-8 text-xl sm:text-2xl font-bold text-gray-800 font-serif text-center\">天机正在演算...</p>\r\n            <p className=\"mt-2 text-sm sm:text-md text-gray-500 text-center font-sans\">一段佳缘，即将浮现...</p>\r\n          </div>\r\n        );\r\n\r\n      case 'result':\r\n        return (\r\n          <div className=\"flex flex-col items-center p-6 sm:p-8 bg-white rounded-3xl shadow-2xl border-4 border-rose-300 max-w-lg w-full text-center animate-fade-in font-sans\">\r\n            <h2 className=\"text-3xl sm:text-4xl font-bold text-gray-900 mb-4 font-serif\">你的正缘</h2>\r\n            \r\n            <img\r\n              src={result?.hdImage || '/default_image.svg'}\r\n              alt=\"正缘画像\"\r\n              className={`w-full max-w-[20rem] aspect-[2/3] object-cover rounded-2xl shadow-xl transition-all duration-500`}\r\n              onError={(e) => {\r\n                e.target.src = '/default_image.svg';\r\n              }}\r\n            />\r\n            \r\n            {result.poeticText && (\r\n              <p className=\"mt-6 sm:mt-8 text-lg sm:text-xl text-gray-700 italic font-serif leading-relaxed px-4 border-l-4 border-rose-400\">\r\n                {result.poeticText}\r\n              </p>\r\n            )}\r\n\r\n            <div className=\"mt-6 sm:mt-10 w-full space-y-6\">\r\n              <h3 className=\"text-xl sm:text-2xl font-bold text-gray-800 font-serif border-b-2 border-rose-400 pb-2\">详细解读</h3>\r\n              <p className=\"text-left text-base sm:text-lg text-gray-700 leading-relaxed whitespace-pre-wrap\">\r\n                {result.detailedAnalysis}\r\n              </p>\r\n            </div>\r\n            \r\n            <div className=\"mt-6 sm:mt-8 w-full flex\">\r\n              <button\r\n                onClick={() => {\r\n                  // 清除结果并返回输入页面\r\n                  setStep('input');\r\n                  setResult(null);\r\n                  // 刷新用户数据，确保免费机会数量正确\r\n                  fetchUserData();\r\n                }}\r\n                className=\"flex-1 py-3 sm:py-4 px-6 bg-gray-200 text-gray-800 font-semibold rounded-xl hover:bg-gray-300 transition-colors duration-300\"\r\n              >\r\n                <span role=\"img\" aria-label=\"repeat\" className=\"mr-2\">🔄</span>\r\n                重新求签\r\n              </button>\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-rose-50 to-orange-100 flex items-center justify-center p-4 sm:p-6 font-sans\">\r\n      <style>\r\n        {`\r\n        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap');\r\n        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');\r\n        .font-serif {\r\n          font-family: 'Noto Serif SC', serif;\r\n        }\r\n        .font-sans {\r\n          font-family: 'Inter', sans-serif;\r\n        }\r\n        .animate-fade-in {\r\n          animation: fadeIn 0.5s ease-out forwards;\r\n        }\r\n        .animate-pop-in {\r\n          animation: popIn 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;\r\n        }\r\n        .animate-scale-in {\r\n          animation: scaleIn 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;\r\n        }\r\n        .animate-spin-slow {\r\n          animation: spin 3s linear infinite;\r\n        }\r\n        .animate-shake {\r\n          animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both;\r\n          transform: translate3d(0, 0, 0);\r\n          backface-visibility: hidden;\r\n          perspective: 1000px;\r\n        }\r\n        .animate-fade-in-up {\r\n            animation: fadeInUp 0.6s ease-out forwards;\r\n        }\r\n        @keyframes fadeIn {\r\n          from { opacity: 0; }\r\n          to { opacity: 1; }\r\n        }\r\n        @keyframes popIn {\r\n          from { transform: scale(0.95); opacity: 0; }\r\n          to { transform: scale(1); opacity: 1; }\r\n        }\r\n        @keyframes scaleIn {\r\n          from { transform: scale(0); opacity: 0; }\r\n          to { transform: scale(1); opacity: 1; }\r\n        }\r\n        @keyframes spin {\r\n          from { transform: rotate(0deg); }\r\n          to { transform: rotate(360deg); }\r\n        }\r\n        @keyframes shake {\r\n          10%, 90% { transform: translate3d(-1px, 0, 0); }\r\n          20%, 80% { transform: translate3d(2px, 0, 0); }\r\n          30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }\r\n          40%, 60% { transform: translate3d(4px, 0, 0); }\r\n        }\r\n        @keyframes fadeInUp {\r\n            from {\r\n                opacity: 0;\r\n                transform: translateY(20px);\r\n            }\r\n            to {\r\n                opacity: 1;\r\n                transform: translateY(0);\r\n            }\r\n        }\r\n        `}\r\n      </style>\r\n      <div className=\"w-full max-w-2xl relative\">\r\n        <div className=\"absolute top-4 right-4 z-40\">\r\n          <button\r\n            onClick={() => setShowDocumentation(!showDocumentation)}\r\n            className=\"flex items-center space-x-2 py-2 px-4 bg-white bg-opacity-80 backdrop-filter backdrop-blur-lg text-gray-700 font-semibold rounded-full shadow-lg hover:bg-opacity-100 hover:text-rose-500 transition-all duration-300\"\r\n          >\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6.253v13m0-13C10.832 5.467 9.5 5 8 5c-4 0-4 6-4 6s4 6 4 6c1.5 0 2.832-.467 4-1.253m0 0C13.168 18.533 14.5 19 16 19c4 0 4-6 4-6s-4-6-4-6c-1.5 0-2.832.467-4 1.253\" />\r\n            </svg>\r\n            <span className=\"hidden sm:inline\">功能说明</span>\r\n          </button>\r\n        </div>\r\n        {renderContent()}\r\n      </div>\r\n      {/* 用户信息已通过状态管理 */}\r\n      {modalMessage && <Modal message={modalMessage} onClose={() => setModalMessage(null)} />}\r\n      {showShareModal && <ShareModal onShareSuccess={handleShareSuccess} onClose={() => setShowShareModal(false)} canShareAgain={canShareAgain} />}\r\n      {showPurchaseModal && <PurchaseModal onPurchaseSuccess={handlePurchaseSuccess} onClose={() => setShowPurchaseModal(false)} API_BASE_URL={API_BASE_URL} />}\r\n\r\n\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}